apiVersion: v1
data:
    config.yaml: |
        # WebDAV Server Configuration
        address: 0.0.0.0
        port: 8080

        # Prefix to apply to the WebDAV path-ing. Default is '/'.
        prefix: /

        # Enable or disable debug logging. Default is 'false'.
        debug: false

        # Disable sniffing the files to detect their content type. Default is 'false'.
        noSniff: false

        # Whether the server runs behind a trusted proxy or not. When this is true,
        # the header X-Forwarded-For will be used for logging the remote addresses
        # of logging attempts (if available).
        behindProxy: true

        # The directory that will be able to be accessed by the users when connecting.
        directory: /data

        # The default permissions for users. This is a case insensitive option. Possible
        # permissions: C (Create), R (Read), U (Update), D (Delete).
        permissions: CRUD

        # Logging configuration
        log:
          format: json
          colors: false
          outputs:
          - stderr

        # CORS configuration
        cors:
          enabled: true
          credentials: true
          allowed_headers:
            - Depth
            - Content-Type
            - Authorization
          allowed_methods:
            - GET
            - HEAD
            - POST
            - PUT
            - DELETE
            - OPTIONS
            - PROPFIND
            - PROPPATCH
            - MKCOL
            - COPY
            - MOVE
            - LOCK
            - UNLOCK
          exposed_headers:
            - Content-Length
            - Content-Range
            - DAV

        # User authentication
        users:
          - username: "{env}WEBDAV_USERNAME"
            password: "{env}WEBDAV_PASSWORD"
            permissions: CRUD
kind: ConfigMap
metadata:
    creationTimestamp: null
    labels:
        app: webdav
        managed-by: personal-server
    name: webdav-config
    namespace: infra
