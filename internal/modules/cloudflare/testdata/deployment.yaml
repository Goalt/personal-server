metadata:
    creationTimestamp: null
    labels:
        app: cloudflared
        managed-by: personal-server
    name: cloudflared-deployment
    namespace: infra
spec:
    replicas: 2
    selector:
        matchLabels:
            pod: cloudflared
    strategy: {}
    template:
        metadata:
            creationTimestamp: null
            labels:
                pod: cloudflared
        spec:
            containers:
                - command:
                    - cloudflared
                    - tunnel
                    - --no-autoupdate
                    - --loglevel
                    - debug
                    - --metrics
                    - 0.0.0.0:2000
                    - run
                  env:
                    - name: TUNNEL_TOKEN
                      valueFrom:
                        secretKeyRef:
                            key: token
                            name: tunnel-token
                  image: cloudflare/cloudflared:2025.11.1
                  livenessProbe:
                    failureThreshold: 1
                    httpGet:
                        path: /ready
                        port: 2000
                    initialDelaySeconds: 10
                    periodSeconds: 10
                  name: cloudflared
                  resources: {}
            securityContext:
                sysctls:
                    - name: net.ipv4.ping_group_range
                      value: 65532 65532
status: {}
